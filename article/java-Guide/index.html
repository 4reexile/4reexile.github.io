<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Java审计指南 | Iz0fPriestess</title><meta name="author" content="Creexile"><meta name="copyright" content="Creexile"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="cup是杯子,cdown是倒过来的杯子">
<meta property="og:type" content="article">
<meta property="og:title" content="Java审计指南">
<meta property="og:url" content="https://4reexile.github.io/article/java-Guide/index.html">
<meta property="og:site_name" content="Iz0fPriestess">
<meta property="og:description" content="cup是杯子,cdown是倒过来的杯子">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://4reexile.github.io/img/tx.png">
<meta property="article:published_time" content="2025-08-19T16:00:00.000Z">
<meta property="article:modified_time" content="2025-11-21T07:52:21.849Z">
<meta property="article:author" content="Creexile">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="反序列化">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://4reexile.github.io/img/tx.png"><link rel="shortcut icon" href="/img/prts.ico"><link rel="canonical" href="https://4reexile.github.io/article/java-Guide/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?76992a4541699d4a08e36c0eb02f7796";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Java审计指南',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-11-21 15:52:21'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/tx.png" onerror="onerror=null;src='/img/sddd.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">103</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">107</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">13</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> Articles</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/bjt.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Iz0fPriestess"><span class="site-name">Iz0fPriestess</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> Articles</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Java审计指南</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-08-19T16:00:00.000Z" title="Created 2025-08-20 00:00:00">2025-08-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-11-21T07:52:21.849Z" title="Updated 2025-11-21 15:52:21">2025-11-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">4.5k</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>参考文章:</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mjs154/p/11667796.html">springmvc Controller接收前端参数的几种方式总结</a></li>
</ol>
<h1>审计</h1>
<h2 id="准备工作"><a class="header-anchor" href="#准备工作">¶</a>准备工作</h2>
<p>在审计之前，按照如下步骤，了解框架、技术架构和业务逻辑</p>
<ol>
<li>了解应用系统主要业务逻辑，</li>
<li>了解项目的结构和项目当中的类依赖。</li>
<li>根据业务模块去读对应的代码，从功能去关联业务代码往往比逮着段代码就看效率高很多。</li>
</ol>
<h2 id="全文通读"><a class="header-anchor" href="#全文通读">¶</a>全文通读</h2>
<p>初步分析其系统存在的安全控制措施，如框架安全机制、安全组件、过滤器、拦截器等</p>
<p>从系统的入口开始审计，梳理清楚数据流及控制流走向，列出分析表</p>
<h2 id="敏感函数"><a class="header-anchor" href="#敏感函数">¶</a>敏感函数</h2>
<p>通过搜索敏感函数关键字，分析其是否存在安全缺陷，逆向追踪参数的传递过程，分析参数是否用户可控</p>
<h1>全文审计</h1>
<p>函数集文件：通常文件名中包含function或者common等关键词，这些文件里面是一些公共函数，提供给其他文件统一调用，想要寻找这些文件可以在index.php或者一些功能性文件，一般都能找到。</p>
<p>配置文件：通常命名中包含config关键词，配置文件中可以了解CMS使用时必要的功能性配置选项以及数据库等配置信息，另外在观看配置文件时可以注意观察配置文件中参数值是否采用双引号，如果采用双引号，可能会存在代码执行漏洞。</p>
<p>安全过滤文件：安全过滤文件对于做审计非常重要，关系到我们挖掘到漏洞点的利用，通常文件名中包含filter、safe、check等关键词，这类文件主要是对参数进行过滤，如 sql、xss、rce等。</p>
<h1>根据功能点定向审计</h1>
<p>文件上传: 对文件类型没有做严格过滤,或对文件名没有进行过滤造成sql注入</p>
<p>文件管理系统: 文件名或文件路径直接在参数中传递, 可能导致任意文件操作</p>
<p>登录认证功能: 未加盐/算法可逆,可能导致知道用户部分信息就可以登入他人账户</p>
<p>找回密码: 找回管理员密码</p>
<p>验证码爆破</p>
<h1>通用漏洞审计</h1>
<table>
<thead>
<tr>
<th>漏洞名称</th>
<th>关键词</th>
</tr>
</thead>
<tbody>
<tr>
<td>密码硬编码、密码明文存储</td>
<td><code>password</code>、<code>pass</code>、<code>jdbc</code></td>
</tr>
<tr>
<td>XSS</td>
<td><code>getParamter</code>、<code>&lt;%= =%&gt;</code>、<code>param</code></td>
</tr>
<tr>
<td>SQL 注入</td>
<td><code>Select</code>、<code>Dao</code>、<code>from</code>、<code>delete</code>、<code>update</code>、<code>insert</code></td>
</tr>
<tr>
<td>任意文件下载</td>
<td><code>download</code> 、<code>fileName</code> 、<code>filePath</code>、<code>write</code>、<code>getFile</code>、<code>getWriter</code></td>
</tr>
<tr>
<td>任意文件删除</td>
<td><code>Delete</code>、<code>deleteFile</code>、<code>fileName</code> 、<code>filePath</code></td>
</tr>
<tr>
<td>文件上传</td>
<td><code>Upload</code>、<code>write</code>、<code>fileName</code> 、<code>filePath</code></td>
</tr>
<tr>
<td>命令注入</td>
<td><code>getRuntime</code>、<code>exec</code>、<code>cmd</code>、<code>shell</code></td>
</tr>
<tr>
<td>缓冲区溢出</td>
<td><code>strcpy</code>,<code>strcat</code>,<code>scanf</code>,<code>memcpy</code>,<code>memmove</code>,<code>memeccpy</code> <code>Get()</code>,<code>fgetc()</code>,<code>getchar</code>;<code>read</code>,<code>printf</code></td>
</tr>
<tr>
<td>XML注入</td>
<td><code>DocumentBuilder</code>、<code>XMLStreamReader</code>、<code>SAXBuilder</code>、<code>SAXParser</code> <code>SAXReader</code> 、<code>XMLReader</code> <code>SAXSource</code> 、<code>TransformerFactory</code> 、<code>SAXTransformerFactory</code> <code>SchemaFactory</code></td>
</tr>
<tr>
<td>反序列化漏洞</td>
<td><code>ObjectlnputStream.readObject</code> 、<code>ObjectlnputStream.readUnshared</code>、<code>XMLDecoder.readObject</code> <code>Yaml.load</code> 、 <code>XStream.fromXML</code> 、<code>ObjectMapper.readValue</code> 、 <code>JSON.parseObject</code></td>
</tr>
<tr>
<td>url跳转</td>
<td><code>sendRedirect</code>、<code>setHeader</code>、<code>forward</code></td>
</tr>
<tr>
<td>不安全组件暴露</td>
<td><code>activity</code>、<code>Broadcast Receiver</code>、<code>Content Provider</code>、<code>Service</code>、 <code>inter-filter</code></td>
</tr>
<tr>
<td>日志记录敏感信息</td>
<td><code>log</code> <code>log.info</code> <code>logger.info</code></td>
</tr>
<tr>
<td>代码执行</td>
<td><code>eval</code>、<code>system</code>、<code>exec</code></td>
</tr>
</tbody>
</table>
<h1>基于关键词审计的漏洞</h1>
<h2 id="密码硬编码"><a class="header-anchor" href="#密码硬编码">¶</a>密码硬编码</h2>
<p>直接搜就完了</p>
<h2 id="XSS"><a class="header-anchor" href="#XSS">¶</a>XSS</h2>
<h3 id="反射型XSS"><a class="header-anchor" href="#反射型XSS">¶</a>反射型XSS</h3>
<p>反射型 XSS 一般 fortify 一般都能扫描出来
如果是手工找，可全局搜索以下关键词</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">getParamter</span><br><span class="line">&lt;%= 或 =%&gt;</span><br><span class="line">param</span><br><span class="line">$&#123;</span><br></pre></td></tr></table></figure>
<p>Servlet:
request.getParameter(“name”)</p>
<p>Struts2:
通过Action类绑定参数或model自动获取前端的参数
通过action属性接收参数</p>
<p>SpringMVC:
对象方式(类似Struts2)
自定义参数名
使用requestbody绑定注解获取参数
request获取参数值</p>
<p>特点:
前端-&gt;后端无过滤
后端-&gt;前端无过滤</p>
<h3 id="存储型XSS"><a class="header-anchor" href="#存储型XSS">¶</a>存储型XSS</h3>
<p>两种方式:</p>
<p>第一种:
关键词: <code>insert</code>,<code>save</code>,<code>update</code>
然后找到该插入语句所属的方法名如(<code>insertUser()</code>)，然后全局搜索该方法在哪里被调用，一层层的跟踪。直到<code>getParamter()</code>方法获取请求参数的地方停止</p>
<p>第二种:
从<code>getParamter</code>关键词开始 ，跟踪请求参数，直到插入数据库的语句，如果中间没有过 滤参数，则存在存储型 XSS</p>
<h2 id="SQL注入"><a class="header-anchor" href="#SQL注入">¶</a>SQL注入</h2>
<p>fortify 一般都能扫描出来</p>
<h3 id="特征"><a class="header-anchor" href="#特征">¶</a>特征</h3>
<p>原生jdbc
使用statement对象进行数据库操作，未使用prepareStatement预编译</p>
<p>Mybatis：
使用<code>$&#123;&#125;</code>拼接用户输入</p>
<p>SQL注入常见关键字：
<code>Statement</code>、<code>createStatement</code>、<code>executeQuery</code>、<code>executeUpdate</code>、<code>execute</code>、<code>prepareStatement</code>、<code>$&#123;</code>
<code>select</code>,<code>update</code>,<code>$(</code>,<code>#</code>,<code>+append</code>等等
还有什么 <code>+table</code>,<code>+id+</code>等等,那些自己整吧</p>
<p>当找到某个变量关键词有 SQL 注入漏洞时，还可以直接全局搜索那个关键词找出类似漏洞 的文件
要查找那个页面调用到含有漏洞的代码，就要跟踪方法的调用栈</p>
<h3 id="步骤"><a class="header-anchor" href="#步骤">¶</a>步骤</h3>
<p>原生jdbc：
1. 搜索<code>Statement</code>、<code>createStatement</code>、<code>executeQuery</code>、<code>executeUpdate</code>、<code>execute</code>等关键字，确定使用Statement对象执行SQL语句的代码。
2. 检查<code>executeQuery</code>、<code>executeUpdate</code>、<code>execute</code>函数的参数是否经过充分过滤，是否对危险字符进行转译。
3. 若使用了<code>Statement</code>对象执行SQL语句，且<code>executeQuery</code>、<code>executeUpdate</code>、<code>execute</code>函数过滤不严格，则存在SQL注入
4. 搜索关键字<code>prepareStatement</code>、<code>executeQuery</code>、<code>executeUpdate</code>、<code>execute</code>确定使用预编译对象<code>prepareStatement</code>执行SQL语句的代码。
5. 检查在构造SQL语句时，拼接用户输入的位置是否使用“?”占位。</p>
<p>Mybatis：
1. 在mapper文件中搜索 <code>$&#123;</code> ，检查是否使用 <code>$&#123;&#125;</code> 拼接用户输入
2. 对于无法使用<code>#&#123;&#125;</code> 拼接用户输入的位置，寻找调用该SQL语句前是否对<code>$&#123;&#125;</code>内的参数进行过滤或转译。
3. 若全部使用<code>#&#123;&#125;</code>拼接用户输入，则不存在生SQL注入；若使用<code>$&#123;&#125;</code>的位置进行严格过滤或转译，则不存在SQL注入。</p>
<p>SQL注入高发位置：
由于SQL语句中部分位置不支持预编译，或使用预编译时将改变SQL原有语法，这些位置将成为SQL注入高发点，如order by 、like 等位置后的参数，应着重进行审计</p>
<h2 id="任意文件下载"><a class="header-anchor" href="#任意文件下载">¶</a>任意文件下载</h2>
<h3 id="特征-v2"><a class="header-anchor" href="#特征-v2">¶</a>特征</h3>
<p>审计方法：全局搜索以下关键词
<code>fileName</code>
<code>filePath</code>
<code>getFile</code>
<code>getWriter</code></p>
<h2 id="任意文件删除"><a class="header-anchor" href="#任意文件删除">¶</a>任意文件删除</h2>
<h3 id="特征-v3"><a class="header-anchor" href="#特征-v3">¶</a>特征</h3>
<p><code>delete</code>, <code>deleteFile</code>,<code>fileName</code> ,<code>filePath</code></p>
<h2 id="XPath注入"><a class="header-anchor" href="#XPath注入">¶</a>XPath注入</h2>
<h3 id="特征-v4"><a class="header-anchor" href="#特征-v4">¶</a>特征</h3>
<p>Xpath注入关键字：
<code>DocumentBuilder</code>、<code>XPathFactory</code>、<code>XPath</code>、<code>XPathExpression</code>、<code>evaluate</code>等</p>
<h3 id="审计"><a class="header-anchor" href="#审计">¶</a>审计</h3>
<ol>
<li>搜索<code>DocumentBuilder</code>、<code>XPathFactory</code>、<code>XPath</code>、<code>XPathExpression</code>等关键字，定位使用Xpath相关代码位置；</li>
<li>检查使用<code>XPath.compile()</code>函数生成<code>XPathExpression</code>时，<code>compile</code>函数的参数是否对用户输入进行拼接；</li>
<li>若<code>XPath.compile()</code>函数的参数直接拼接用户输入，或者对用户输入过滤不严格，则存在XPath注入</li>
</ol>
<h2 id="XML注入"><a class="header-anchor" href="#XML注入">¶</a>XML注入</h2>
<h3 id="特征-v5"><a class="header-anchor" href="#特征-v5">¶</a>特征</h3>
<p>Java可用的xml解析器很多，比如<code>XMLReaderFactory</code>、<code>XMLReader</code>、<code>DocumentBuilderFactory</code>、<code>SAXReader</code>、<code>SAXParserFactory</code>等等</p>
<p>XML实体注入关键字：
<code>XMLReaderFactory</code>、<code>XMLReader</code>、<code>DocumentBuilder</code>、<code>SAXBuilder</code>、<code>SAXParserFactory</code>、<code>parse</code>、<code>setFeature</code>,<code>XMLStreamReader</code>,<code>SAXParser</code>,<code>SAXSource</code>.<code>TransformerFactory</code>.<code>SAXTransformerFactory</code>, <code>SchemaFactory</code>
<code>validate</code></p>
<h3 id="审计-v2"><a class="header-anchor" href="#审计-v2">¶</a>审计</h3>
<ol>
<li>搜索XML实体注入关键字（如XMLReader、SAXReader），定位解析xml的代码块；</li>
<li>检查是否正确设置解析器特性；</li>
<li>若xml解析器没有正确设置解析特性，则存在XML实体注入；</li>
</ol>
<p>补充：推荐特性设置：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">xmlReader.setFeature(<span class="string">&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;</span>, <span class="literal">true</span>);    <span class="comment">// 禁用DTD</span></span><br><span class="line">xmlReader.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-general-entities&quot;</span>, <span class="literal">false</span>); <span class="comment">// 防止外部普通实体</span></span><br><span class="line">xmlReader.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-parameter-entities&quot;</span>, <span class="literal">false</span>); <span class="comment">// 防止外部参数实体</span></span><br></pre></td></tr></table></figure>
<h2 id="命令注入"><a class="header-anchor" href="#命令注入">¶</a>命令注入</h2>
<h3 id="特征-v6"><a class="header-anchor" href="#特征-v6">¶</a>特征</h3>
<p><code>Runtime.exec()</code>函数或<code>processBuilder</code>在构造系统命令时拼接用户输入。
命令注入关键字：
<code>Runtime</code>、<code>exec</code>、<code>processBuilder</code>,<code>cmd</code>,<code>shell</code></p>
<h3 id="审计-v3"><a class="header-anchor" href="#审计-v3">¶</a>审计</h3>
<ol>
<li>搜索关键字<code>Runtime.getRuntime()</code>，<code>processBuilder</code>等关键字定位执行系统命令的代码块；</li>
<li>检查<code>exec()</code>函数的参数是否拼接了用户输入，或在整个数据流中是否对用户输入进行过滤或转译；</li>
<li>检查<code>proceesBuilder.command()</code>函数的参数是否拼接了用户输入，或在整个数据流中是否对用户输入进行过滤或转译；</li>
<li>若<code>exec()</code>函数或<code>command()</code>函数拼接用户参数且过滤不充分，则存在命令注入</li>
</ol>
<p>定位危险入口点，识别所有可能执行系统命令的代码位置</p>
<p><code>Runtime.getRuntime().exec()</code>
<code>ProcessBuilder.start()</code>
反射调用<code>ProcessImpl</code>、<code>UNIXProcess</code>等底层类的方法</p>
<p>审计技巧：
使用IDE全局搜索关键词：<code>exec(</code>、<code>ProcessBuilder</code>、<code>start(</code>、<code>getRuntime()</code>。
检查反射调用：搜索<code>Class.forName()</code>、<code>Method.invoke()</code>等代码块，确认是否操作危险类（如<code>ProcessImpl</code>）。</p>
<h2 id="日志记录敏感信息"><a class="header-anchor" href="#日志记录敏感信息">¶</a>日志记录敏感信息</h2>
<h3 id="特征-v7"><a class="header-anchor" href="#特征-v7">¶</a>特征</h3>
<p>通过搜索关键词 <code>log.info</code> <code>logger.info</code> 来进行定位</p>
<h2 id="CRLF注入"><a class="header-anchor" href="#CRLF注入">¶</a>CRLF注入</h2>
<h3 id="描述"><a class="header-anchor" href="#描述">¶</a>描述</h3>
<p>CRLF是“回车+换行”（\r\n）的简称。</p>
<p>在HTTP协议中，HTTPHeader与HTTPBody是用两个CRLF分隔的，浏览器就是根据这两个CRLF来取出HTTP内容并显示出来。所以，一旦我们能够控制HTTP消息头中的字符，注入一些恶意的换行，这样我们就能注入一些会话Cookie或者HTML代码</p>
<p>所以CRLFInjection又叫HTTPResponseSplitting，简称HRS。</p>
<h3 id="特征-v8"><a class="header-anchor" href="#特征-v8">¶</a>特征</h3>
<p>CRLF漏洞本身没有特殊的关键字，CRLF注入大量出现在重定向功能中，也可以通过搜索<code>Redirect</code>、<code>setHeader</code>、<code>addCookie</code>关键字来定位部分CRLF漏洞</p>
<p>CRLF特殊字符：
<code>\r</code> 、<code>\n</code>、<code>%0a</code>、<code>%0d</code></p>
<h3 id="审计-v4"><a class="header-anchor" href="#审计-v4">¶</a>审计</h3>
<ol>
<li>搜索关键字<code>Redirect</code>、<code>setHeader</code>，定位操作http头部的代码, 关注<code>HttpServletResponse</code>对象</li>
<li>检查<code>sendRedirect</code>函数、<code>setHeader</code>函数的参数中是否拼接了用户输入，或是否对用户输入的回车换行符进行转译过滤；</li>
<li>若上述函数拼接用户输入，且过滤不充分，则存在CRLF注入漏洞</li>
</ol>
<h2 id="不安全的重定向和任意页面跳转"><a class="header-anchor" href="#不安全的重定向和任意页面跳转">¶</a>不安全的重定向和任意页面跳转</h2>
<p>开放重定向漏洞的本质是未对即将跳转的URL进行合法性校验，Javaweb中通常使用sendRedirect函数来进行重定向</p>
<h3 id="特征-v9"><a class="header-anchor" href="#特征-v9">¶</a>特征</h3>
<p><code>sendRedirect</code>、<code>redirect</code>、<code>setHeader</code>, <code>forward</code></p>
<p>需注意有没有配置 url 跳转白名单</p>
<h3 id="审计-v5"><a class="header-anchor" href="#审计-v5">¶</a>审计</h3>
<ol>
<li>搜索<code>sendRedirect</code>、<code>redirect</code>、<code>setHeader</code>等关键字，定位实现重定向功能的代码块</li>
<li>检查代码中是否对即将跳转的URL地址合法性进行限制；</li>
<li>检查URL合法性校验中，是否使用<code>startsWith</code>、<code>indexOf</code>等部分匹配校验；</li>
<li>检查URL合法性校验中，是否过滤了JavaScript伪协议；</li>
<li>若代码没有对URL合法性进行校验，则存在开放重定向漏洞，若URL合法性校验时使用部分匹配，则校验容易绕过，若没有过滤JavaScript伪协议，则存在XSS漏洞；</li>
</ol>
<h2 id="敏感信息泄露"><a class="header-anchor" href="#敏感信息泄露">¶</a>敏感信息泄露</h2>
<h3 id="特征-v10"><a class="header-anchor" href="#特征-v10">¶</a>特征</h3>
<p>查看配置文件是否配置统一错误页面，如果有则不存在此漏洞</p>
<p><code>Getmessage</code>、<code>exception</code></p>
<h2 id="路径穿越"><a class="header-anchor" href="#路径穿越">¶</a>路径穿越</h2>
<h3 id="特征-v11"><a class="header-anchor" href="#特征-v11">¶</a>特征</h3>
<p><code>File</code>、<code>getPath</code>、<code>getAbsolutePath</code>、<code>getCanonicalPath</code>、<code>entry.getName</code>、<code>multipartFile.getOriginalFilename</code></p>
<p>路径穿越特殊符号：</p>
<p><code>~</code>、<code>.</code>、<code>..</code>、<code>/</code></p>
<h3 id="审计-v6"><a class="header-anchor" href="#审计-v6">¶</a>审计</h3>
<ol>
<li>搜索<code>File</code>、<code>getPath</code>、<code>getAbsolutePath</code>、<code>entry.getName</code>、<code>multipartFile.getOriginalFilename</code>等关键字，定位操作文件的代码块；</li>
<li>检查实例化File时，Path参数是否拼接用户输入，或者用户输入是否对特殊字符进行过滤或转译；</li>
<li>检查在进行路径校验时，是否使用<code>getAbsolutePath</code>并结合<code>indexOf</code>、<code>startsWith</code>等部分匹配函数进行路径校验；</li>
<li>对于压缩解压操作，检查是否直接使用<code>entry.getName</code>拼接保存路径</li>
<li>若实例化File的参数用户可控，且调用栈中没有进行过滤或转义，则存在路径穿越漏洞；</li>
<li>若使用<code>getAbsolutePath</code>并结合<code>indexOf</code>、<code>startsWith</code>等部分匹配函数进行路径校验，将导致校验函数被绕过，存在路径穿越漏洞（应使用<code>getCanonicalPath</code>函数）</li>
<li>若解压文件时直接使用<code>entry.getName</code>拼接保存路径，且后续不再校验路径，则存在路径穿越漏洞。</li>
</ol>
<h2 id="任意文件上传"><a class="header-anchor" href="#任意文件上传">¶</a>任意文件上传</h2>
<p>任意文件覆盖似乎也是这个</p>
<h3 id="特征-v12"><a class="header-anchor" href="#特征-v12">¶</a>特征</h3>
<p>需注意有没有配置文件上传白名单</p>
<p><code>MultipartFile</code>、<code>FileItem</code>、<code>upload</code>、<code>transferTo</code>，<code>write</code>,<code>fileName</code> ,<code>filePath</code></p>
<h3 id="审计-v7"><a class="header-anchor" href="#审计-v7">¶</a>审计</h3>
<ol>
<li>搜索<code>MultipartFile</code>、<code>FileItem</code>、<code>upload</code>、<code>transferTo</code>等关键字，定位实现文件上传的代码块；</li>
<li>检查代码中是否对文件保存路径进行限制（参考路径穿越章节）；</li>
<li>检查代码中是否对文件类型进行校验；</li>
<li>检查文件类型校验是否可绕过，内容包括但不限于以下几个小类：
使用黑名单还是白名单校验，黑名单是否完备；
使用文件后缀还是MIME获取文件类型；
使用后缀名校验文件类型时，是否正确取后缀；是否对大小写进行统一后再校验</li>
<li>若文件类型没有校验，则存在任意文件上传漏洞；</li>
<li>文件类型黑名单，或大小写未统一，存在遗漏，则存在漏洞；</li>
</ol>
<h2 id="SSRF"><a class="header-anchor" href="#SSRF">¶</a>SSRF</h2>
<h3 id="特征-v13"><a class="header-anchor" href="#特征-v13">¶</a>特征</h3>
<p><code>URLConnection</code>、<code>HTTPConnection</code></p>
<h3 id="审计-v8"><a class="header-anchor" href="#审计-v8">¶</a>审计</h3>
<ol>
<li>搜索<code>URLConnection</code>、<code>HTTPConnection</code>等关键字，定位发起服务端请求的代码块；</li>
<li>检查目标地址URL是否用户可控，是否对目标地址合法性进行检查；</li>
<li>检查目标地址合法性时，是否使用<code>startsWith</code>、<code>indexOf</code>等部分匹配</li>
<li>若<code>HTTPConnection</code>、<code>URLConnection</code>的目标地址用户可控，且校验函数可绕过，则存在SSRF漏洞。</li>
</ol>
<h2 id="序列化漏洞"><a class="header-anchor" href="#序列化漏洞">¶</a>序列化漏洞</h2>
<h3 id="特征-v14"><a class="header-anchor" href="#特征-v14">¶</a>特征</h3>
<p>反序列化操作一般在导入模版文件、网络通信、数据传输、日志格式化存储、对象数据落磁 盘或 DB 存储等业务场景,在代码审计时可重点关注一些反序列化操作函数并判断输入是否可控</p>
<p>反序列化漏洞关键字：
<code>ObjectInputStream</code>、<code>ObjectOutputStream</code>、<code>serializable</code>、<code>readOject</code>、<code>readExternal</code></p>
<p><code>ObjectInputStream.readObject</code>
<code>ObjectInputStream.readUnshared</code>
<code>XMLDecoder.readObject</code>
<code>Yaml.load</code>
<code>XStream.fromXML</code>
<code>ObjectMapper.readValue</code>
<code>JSON.parseObject</code></p>
<h3 id="审计-v9"><a class="header-anchor" href="#审计-v9">¶</a>审计</h3>
<ol>
<li>搜索实现<code>serializable</code>或<code>external</code>的接口，检查<code>readOject</code>、<code>readExternal</code>等函数中是否进行了危险操作（如删除文件，调用系统命令等）</li>
<li>搜索关键字<code>ObjectInputStream.readObject</code>，检查对数据进行反序列化时，是否对数据进行安全校验（如是否重写了<code>resolveClass</code>并自定义白名单、使用IO流过滤器）</li>
<li>如果程序读取输入流并将其反序列化为对象, 此时可查看项目工程中是否引入可利 用的 commons-collections 3.1、commons-fileupload 1.3.1 等第三方库</li>
</ol>
<h2 id="文件包含"><a class="header-anchor" href="#文件包含">¶</a>文件包含</h2>
<h3 id="特征-v15"><a class="header-anchor" href="#特征-v15">¶</a>特征</h3>
<p><code>include()</code>，<code>require()</code>和<code>include_once()</code>，<code>require_once()</code>等</p>
<h3 id="审计-v10"><a class="header-anchor" href="#审计-v10">¶</a>审计</h3>
<ol>
<li>在jsp、jspx中搜索关键字include；</li>
<li>被包含的文件是否用户可控，是否限定在特定的目录下；</li>
<li>若包含的文件用户完全可控，没有路径限制，则存在任意文件包含漏洞；</li>
</ol>
<h2 id="缓冲区溢出"><a class="header-anchor" href="#缓冲区溢出">¶</a>缓冲区溢出</h2>
<p>主要通过搜索关键词定位，再分析上下文
可搜索以下关键字：
<code>strcpy</code>,<code>strcat</code>,<code>scanf</code>,<code>memcpy</code>,<code>memmove</code>,<code>memeccpy Getc()</code>,<code>fgetc()</code>,<code>getchar</code>;<code>read</code>,<code>printf</code></p>
<h2 id="不安全的第三方组件"><a class="header-anchor" href="#不安全的第三方组件">¶</a>不安全的第三方组件</h2>
<h3 id="审计-v11"><a class="header-anchor" href="#审计-v11">¶</a>审计</h3>
<ol>
<li>获取项目的依赖文件（如pom.xml、lib文件夹）</li>
<li>检查项目依赖的第三方组件是否为存在漏洞的版本</li>
<li>由于第三方组件漏洞在持续更新，建议对第三方组件漏洞进行持续跟踪</li>
</ol>
<p>安卓:
通过查看配置文件<code>AndroidManifest.xml</code>,查看<code>&lt;inter-filter&gt;</code>属性有没有配置 <code>false</code>, 如没有配置, 默认组件可被导出</p>
<p><code>ObjectInputStream.readObject</code>
<code>ObjectInputStream.readUnshared</code>
<code>XMLDecoder.readObject</code>
<code>Yaml.load</code>
<code>XStream.fromXML</code>
<code>ObjectMapper.readValue</code>
<code>JSON.parseObject</code>
<code>Serializable</code></p>
<p><code>commons-io 2.4</code>
<code>commons-collections 3.1</code>
<code>commons-logging 1.2</code>
<code>commons-beanutils 1.9.2</code>
<code>org.slf4j:slf4j-api 1.7.21</code>
<code>com.mchange:mchange-commons-java 0.2.11</code>
<code>org.apache.commons:commons-collections 4.0</code>
<code>com.mchange:c3p0 0.9.5.2</code>
<code>org.beanshell:bsh 2.0b5</code>
<code>org.codehaus.groovy:groovy 2.3.9</code>
<code>org.springframework:spring-aop4.1.4.RELEASE</code></p>
<h1>逻辑漏洞</h1>
<h2 id="水平越权"><a class="header-anchor" href="#水平越权">¶</a>水平越权</h2>
<p>水平越权本身没有特定的关键字，应在审计过程中关注系统业务逻辑</p>
<p>重点关注用户操作请求时查看是否有对当前登陆用户权限做校验从而确定是否存在漏洞，有些厂商会使用一些主流的权限框架，例如 <code>shiro</code> ,<code>spring security</code> 等框架，那么需要重点关注框架的配置文件以及实现方法</p>
<h3 id="审计-v12"><a class="header-anchor" href="#审计-v12">¶</a>审计</h3>
<ol>
<li>对业务功能的逻辑处理流程进行梳理，分析流程中是否判断了请求与请求发起者之间的绑定关系。</li>
<li>找到一个功能点，检查请求参数中是否包含了可以验证用户身份的信息，如短信验证码。然后，分析该功能的处理逻辑中是否对用户标识（userID等）进行了判断，检查该用户标识是否用户可控。</li>
<li>当该功能未判断请求与请求发起者之间的绑定关系，或用于判断绑定关系的各参数用户可控（cookie中的未加密内容，Http请求头中的内容，Http正文中的内容一般都认为是用户可控内容），则该功能存在水平越权漏洞。</li>
</ol>
<h2 id="垂直越权"><a class="header-anchor" href="#垂直越权">¶</a>垂直越权</h2>
<p>同上</p>
<p>搜索关键字<code>getRequestURI</code>，发现该<code>/add/user</code>接口通过<code>getRequestURI</code>方法获取当前URL，若<code>getRequestURI</code>返回值以admin开头。则要求session中admin取值为admin，才能访问URL。但是<code>getRequestURI</code>和<code>startsWith</code>联合使用时，可以通过<code>/aaa/bbb/../../admin/add/user</code>，来调用<code>/admin/add/user</code>接口</p>
<h1>其他漏洞审计方法</h1>
<h2 id="csrf"><a class="header-anchor" href="#csrf">¶</a>csrf</h2>
<h3 id="特征-v16"><a class="header-anchor" href="#特征-v16">¶</a>特征</h3>
<p>通过查看配置文件有没有配置 csrf 全局过滤器，如果没有则重点看每个操作前有
没有添加 token 的防护机制</p>
<h2 id="会话超时设置"><a class="header-anchor" href="#会话超时设置">¶</a>会话超时设置</h2>
<p>Javaweb 应用会话超时设置一般有俩种方法：</p>
<p>一是在配置文件 <code>web.xml</code> 设置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>15<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>二是通过 java 代码设置</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line">session.setMaxInactiveInterval(<span class="number">60</span>); <span class="comment">// 单位: 秒</span></span><br></pre></td></tr></table></figure>
<h2 id="敏感数据弱加密"><a class="header-anchor" href="#敏感数据弱加密">¶</a>敏感数据弱加密</h2>
<blockquote>
<p>不需要写入报告中</p>
</blockquote>
<p>看看数据传输中的加密方法, 不能仅用base64, 可以用换表base64嘛</p>
<h2 id="session"><a class="header-anchor" href="#session">¶</a>session</h2>
<p>成功登陆之后是否会更新SessionID
session是否有超时注销功能</p>
<h2 id="cookie"><a class="header-anchor" href="#cookie">¶</a>cookie</h2>
<p>是否设置了Cookie的httponly属性
是否在cookie中设置明文的用户名或用户编号，且服务端根据该信息来鉴权。</p>
<h2 id="密码管理"><a class="header-anchor" href="#密码管理">¶</a>密码管理</h2>
<p>密码是否以不可逆的哈希形态存储
是否使用不带salt的哈希算法来加密密码
加密哈希算法中的salt是否硬编码在代码中</p>
<p>检查密码修改功能请求中是否有用户名或用户编号，且服务端以该参数来选择需要修改密码的用户，如有则存在越权</p>
<h1>高危组件漏洞</h1>
<h2 id="shiro"><a class="header-anchor" href="#shiro">¶</a>shiro</h2>
<h2 id="Weblogic"><a class="header-anchor" href="#Weblogic">¶</a>Weblogic</h2>
<h2 id="Fastjson"><a class="header-anchor" href="#Fastjson">¶</a>Fastjson</h2>
<p><code>parse</code> 和 <code>parseObject</code></p>
<h2 id="Struts2"><a class="header-anchor" href="#Struts2">¶</a>Struts2</h2>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://4reexile.github.io">Creexile</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://4reexile.github.io/article/java-Guide/">https://4reexile.github.io/article/java-Guide/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">反序列化</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/article/ruoyi4.2/" title="RuoYi-4.2代码审计"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">RuoYi-4.2代码审计</div></div></a></div><div class="next-post pull-right"><a href="/article/Java-ref/" title="Java反射"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">Java反射</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/article/Java-pre01/" title="Java反序列化漏洞核心组件"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-25</div><div class="title">Java反序列化漏洞核心组件</div></div></a></div><div><a href="/article/java-unser/" title="Java反序列化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-05</div><div class="title">Java反序列化</div></div></a></div><div><a href="/article/6591/" title="Log4j反序列化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-03</div><div class="title">Log4j反序列化</div></div></a></div><div><a href="/article/snakeyaml-unser/" title="SnakeYaml反序列化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-23</div><div class="title">SnakeYaml反序列化</div></div></a></div><div><a href="/article/shiro-unser/" title="Shiro反序列化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-01</div><div class="title">Shiro反序列化</div></div></a></div><div><a href="/article/XStreadm-unser/" title="XStreadm反序列化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-15</div><div class="title">XStreadm反序列化</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/tx.png" onerror="this.onerror=null;this.src='/img/sddd.gif'" alt="avatar"/></div><div class="author-info__name">Creexile</div><div class="author-info__description">Don't walk with waning motive.</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">103</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">107</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">13</div></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">审计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.1.</span> <span class="toc-text">准备工作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E6%96%87%E9%80%9A%E8%AF%BB"><span class="toc-number">1.2.</span> <span class="toc-text">全文通读</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.</span> <span class="toc-text">敏感函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">全文审计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">根据功能点定向审计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">通用漏洞审计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">基于关键词审计的漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E7%A1%AC%E7%BC%96%E7%A0%81"><span class="toc-number">5.1.</span> <span class="toc-text">密码硬编码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS"><span class="toc-number">5.2.</span> <span class="toc-text">XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-number">5.2.1.</span> <span class="toc-text">反射型XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8BXSS"><span class="toc-number">5.2.2.</span> <span class="toc-text">存储型XSS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">5.3.</span> <span class="toc-text">SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81"><span class="toc-number">5.3.1.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4"><span class="toc-number">5.3.2.</span> <span class="toc-text">步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">5.4.</span> <span class="toc-text">任意文件下载</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v2"><span class="toc-number">5.4.1.</span> <span class="toc-text">特征</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4"><span class="toc-number">5.5.</span> <span class="toc-text">任意文件删除</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v3"><span class="toc-number">5.5.1.</span> <span class="toc-text">特征</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XPath%E6%B3%A8%E5%85%A5"><span class="toc-number">5.6.</span> <span class="toc-text">XPath注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v4"><span class="toc-number">5.6.1.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1"><span class="toc-number">5.6.2.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XML%E6%B3%A8%E5%85%A5"><span class="toc-number">5.7.</span> <span class="toc-text">XML注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v5"><span class="toc-number">5.7.1.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1-v2"><span class="toc-number">5.7.2.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-number">5.8.</span> <span class="toc-text">命令注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v6"><span class="toc-number">5.8.1.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1-v3"><span class="toc-number">5.8.2.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF"><span class="toc-number">5.9.</span> <span class="toc-text">日志记录敏感信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v7"><span class="toc-number">5.9.1.</span> <span class="toc-text">特征</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRLF%E6%B3%A8%E5%85%A5"><span class="toc-number">5.10.</span> <span class="toc-text">CRLF注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0"><span class="toc-number">5.10.1.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v8"><span class="toc-number">5.10.2.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1-v4"><span class="toc-number">5.10.3.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E9%87%8D%E5%AE%9A%E5%90%91%E5%92%8C%E4%BB%BB%E6%84%8F%E9%A1%B5%E9%9D%A2%E8%B7%B3%E8%BD%AC"><span class="toc-number">5.11.</span> <span class="toc-text">不安全的重定向和任意页面跳转</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v9"><span class="toc-number">5.11.1.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1-v5"><span class="toc-number">5.11.2.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">5.12.</span> <span class="toc-text">敏感信息泄露</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v10"><span class="toc-number">5.12.1.</span> <span class="toc-text">特征</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A"><span class="toc-number">5.13.</span> <span class="toc-text">路径穿越</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v11"><span class="toc-number">5.13.1.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1-v6"><span class="toc-number">5.13.2.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">5.14.</span> <span class="toc-text">任意文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v12"><span class="toc-number">5.14.1.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1-v7"><span class="toc-number">5.14.2.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSRF"><span class="toc-number">5.15.</span> <span class="toc-text">SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v13"><span class="toc-number">5.15.1.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1-v8"><span class="toc-number">5.15.2.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="toc-number">5.16.</span> <span class="toc-text">序列化漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v14"><span class="toc-number">5.16.1.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1-v9"><span class="toc-number">5.16.2.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">5.17.</span> <span class="toc-text">文件包含</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v15"><span class="toc-number">5.17.1.</span> <span class="toc-text">特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1-v10"><span class="toc-number">5.17.2.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA"><span class="toc-number">5.18.</span> <span class="toc-text">缓冲区溢出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E7%AC%AC%E4%B8%89%E6%96%B9%E7%BB%84%E4%BB%B6"><span class="toc-number">5.19.</span> <span class="toc-text">不安全的第三方组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1-v11"><span class="toc-number">5.19.1.</span> <span class="toc-text">审计</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">逻辑漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3%E8%B6%8A%E6%9D%83"><span class="toc-number">6.1.</span> <span class="toc-text">水平越权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1-v12"><span class="toc-number">6.1.1.</span> <span class="toc-text">审计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83"><span class="toc-number">6.2.</span> <span class="toc-text">垂直越权</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">7.</span> <span class="toc-text">其他漏洞审计方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#csrf"><span class="toc-number">7.1.</span> <span class="toc-text">csrf</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%81-v16"><span class="toc-number">7.1.1.</span> <span class="toc-text">特征</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%9A%E8%AF%9D%E8%B6%85%E6%97%B6%E8%AE%BE%E7%BD%AE"><span class="toc-number">7.2.</span> <span class="toc-text">会话超时设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E5%BC%B1%E5%8A%A0%E5%AF%86"><span class="toc-number">7.3.</span> <span class="toc-text">敏感数据弱加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#session"><span class="toc-number">7.4.</span> <span class="toc-text">session</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cookie"><span class="toc-number">7.5.</span> <span class="toc-text">cookie</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86"><span class="toc-number">7.6.</span> <span class="toc-text">密码管理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">8.</span> <span class="toc-text">高危组件漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#shiro"><span class="toc-number">8.1.</span> <span class="toc-text">shiro</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Weblogic"><span class="toc-number">8.2.</span> <span class="toc-text">Weblogic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fastjson"><span class="toc-number">8.3.</span> <span class="toc-text">Fastjson</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Struts2"><span class="toc-number">8.4.</span> <span class="toc-text">Struts2</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/article/6591/" title="Log4j反序列化">Log4j反序列化</a><time datetime="2025-11-21T09:04:57.368Z" title="Updated 2025-11-21 17:04:57">2025-11-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/article/Java-ref/" title="Java反射">Java反射</a><time datetime="2025-11-21T09:02:26.139Z" title="Updated 2025-11-21 17:02:26">2025-11-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/article/Java-agent/" title="Java代理">Java代理</a><time datetime="2025-11-21T09:01:24.787Z" title="Updated 2025-11-21 17:01:24">2025-11-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/article/java-unser/" title="Java反序列化">Java反序列化</a><time datetime="2025-11-21T08:56:20.002Z" title="Updated 2025-11-21 16:56:20">2025-11-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/article/XStreadm-unser/" title="XStreadm反序列化">XStreadm反序列化</a><time datetime="2025-11-21T08:42:39.407Z" title="Updated 2025-11-21 16:42:39">2025-11-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/article/ruoyi4.2/" title="RuoYi-4.2代码审计">RuoYi-4.2代码审计</a><time datetime="2025-11-21T08:31:46.366Z" title="Updated 2025-11-21 16:31:46">2025-11-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Creexile</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async src="/js/custom.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>